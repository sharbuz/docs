import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

## Kubernetes Cluster Requirements

Requirements for **{props.clusterName}** cluster deployment.

### Administrative Permissions

The deployment user must have:

- **{props.clusterName} Admin permissions** with the ability to create and manage namespaces
- Access to configure cluster-level resources (if deploying to an existing cluster)

### Admission Control and Resource Requirements

If deploying to an **existing {props.clusterName} cluster**, ensure that admission webhooks allow the creation of the following Kubernetes resources:

<Tabs>
  <TabItem value="nats" label="NATS Messaging" default>

**Kubernetes API:** `Service` (LoadBalancer type)

**Purpose:** NATS is a core component of the CodeMie Plugin Engine, providing messaging infrastructure for communication between the [codemie-plugins](https://pypi.org/project/codemie-plugins/) CLI tool with MCP and the AI/Run CodeMie platform.

The LoadBalancer configuration depends on where the CLI tool will be executed:

| CLI Tool Execution Location                             | LoadBalancer Type     | Description                                                                 |
| ------------------------------------------------------- | --------------------- | --------------------------------------------------------------------------- |
| Same {props.networkName} as {props.clusterName} cluster | Internal LoadBalancer | Secure, private network communication within the {props.networkName}        |
| External to {props.clusterName} {props.networkName}     | Public LoadBalancer   | Cross-network communication when CLI is run outside the {props.networkName} |

  </TabItem>

  <TabItem value="keycloak" label="Keycloak Operator">

**Kubernetes APIs:** `ClusterRole`, `ClusterRoleBinding`, `Role`, `RoleBinding`, Custom Resource Definitions (CRDs), Custom Resources (CRs)

**Purpose:** Manages Keycloak configuration including realms, clients, and user federation

:::note
Requires cluster-wide permissions for identity and access management operations.
:::

  </TabItem>

  <TabItem value="postgresql" label="PostgreSQL Operator">

**Kubernetes APIs:** `ClusterRole`, `ClusterRoleBinding`, Custom Resource Definitions (CRDs), Custom Resources (CRs)

**Purpose:** Manages PostgreSQL database instances and their lifecycle

:::note
Requires cluster-wide permissions for database provisioning and management.
:::

  </TabItem>

  <TabItem value="security" label="Security Context">

**Kubernetes API:** `Pod` with `securityContext`

**Requirement:** All AI/Run CodeMie components require `readOnlyRootFilesystem: false` in their security context for proper operation

  </TabItem>
</Tabs>
